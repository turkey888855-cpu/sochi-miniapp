<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Админ-панель - TRAVEL SOCHI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .admin-header {
            background: linear-gradient(135deg, #1a237e, #311b92);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .admin-header h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 32px;
            margin-bottom: 10px;
        }
        
        .admin-header p {
            opacity: 0.9;
        }
        
        .admin-nav {
            background: #f5f5f5;
            padding: 20px;
            display: flex;
            gap: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .nav-btn {
            padding: 12px 24px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .nav-btn.active {
            background: #2196F3;
            color: white;
            border-color: #2196F3;
        }
        
        .admin-content {
            padding: 30px;
        }
        
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .reviews-list {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }
        
        .review-item {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border-left: 4px solid #2196F3;
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .review-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-approve {
            background: #4CAF50;
            color: white;
        }
        
        .btn-reject {
            background: #f44336;
            color: white;
        }
        
        .btn-edit {
            background: #FF9800;
            color: white;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 48px;
            font-weight: 800;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
        }
        
        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: flex-end;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-family: inherit;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="admin-container">
        <header class="admin-header">
            <h1><i class="fas fa-crown"></i> Админ-панель TRAVEL SOCHI</h1>
            <p>Управление отзывами, галереей и услугами</p>
        </header>
        
        <nav class="admin-nav">
            <button class="nav-btn active" data-section="reviews">
                <i class="fas fa-comments"></i> Отзывы
            </button>
            <button class="nav-btn" data-section="gallery">
                <i class="fas fa-images"></i> Галерея
            </button>
            <button class="nav-btn" data-section="services">
                <i class="fas fa-umbrella-beach"></i> Услуги
            </button>
            <button class="nav-btn" data-section="stats">
                <i class="fas fa-chart-bar"></i> Статистика
            </button>
        </nav>
        
        <div class="admin-content">
            <!-- Секция отзывов -->
            <section id="reviews-section" class="section active">
                <h2><i class="fas fa-comment-dots"></i> Управление отзывами</h2>
                <p>Модерация новых отзывов и управление опубликованными</p>
                
                <div class="reviews-list" id="admin-reviews-list">
                    <!-- Отзывы будут загружены через JavaScript -->
                </div>
            </section>
            
            <!-- Секция галереи -->
            <section id="gallery-section" class="section">
                <h2><i class="fas fa-images"></i> Управление галереей</h2>
                <p>Добавление и удаление фото/видео материалов</p>
                
                <button class="btn" id="add-media-btn" style="background: #2196F3; color: white; margin-top: 20px;">
                    <i class="fas fa-plus"></i> Добавить медиа
                </button>
                
                <div class="gallery-manager" id="gallery-manager">
                    <!-- Управление галереей -->
                </div>
            </section>
            
            <!-- Секция услуг -->
            <section id="services-section" class="section">
                <h2><i class="fas fa-umbrella-beach"></i> Управление услугами</h2>
                <p>Редактирование и добавление новых услуг</p>
                
                <div id="services-manager">
                    <!-- Управление услугами -->
                </div>
            </section>
            
            <!-- Секция статистики -->
            <section id="stats-section" class="section">
                <h2><i class="fas fa-chart-bar"></i> Статистика</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-comments fa-2x"></i>
                        <div class="stat-number" id="total-reviews">0</div>
                        <div class="stat-label">Всего отзывов</div>
                    </div>
                    
                    <div class="stat-card">
                        <i class="fas fa-star fa-2x"></i>
                        <div class="stat-number" id="avg-rating">0.0</div>
                        <div class="stat-label">Средний рейтинг</div>
                    </div>
                    
                    <div class="stat-card">
                        <i class="fas fa-images fa-2x"></i>
                        <div class="stat-number" id="total-media">0</div>
                        <div class="stat-label">Фото/видео</div>
                    </div>
                    
                    <div class="stat-card">
                        <i class="fas fa-users fa-2x"></i>
                        <div class="stat-number" id="total-services">0</div>
                        <div class="stat-label">Услуг</div>
                    </div>
                </div>
            </section>
        </div>
    </div>
    
    <!-- Модальное окно редактирования отзыва -->
    <div class="modal" id="edit-modal">
        <div class="modal-content">
            <h3><i class="fas fa-edit"></i> Редактирование отзыва</h3>
            
            <div class="form-group">
                <label>Имя:</label>
                <input type="text" id="edit-name">
            </div>
            
            <div class="form-group">
                <label>Услуга:</label>
                <select id="edit-service"></select>
            </div>
            
            <div class="form-group">
                <label>Оценка:</label>
                <div class="rating-edit">
                    <span class="edit-star" data-value="1">★</span>
                    <span class="edit-star" data-value="2">★</span>
                    <span class="edit-star" data-value="3">★</span>
                    <span class="edit-star" data-value="4">★</span>
                    <span class="edit-star" data-value="5">★</span>
                </div>
                <input type="hidden" id="edit-rating" value="0">
            </div>
            
            <div class="form-group">
                <label>Текст отзыва:</label>
                <textarea id="edit-text"></textarea>
            </div>
            
            <div class="modal-actions">
                <button class="btn btn-approve" id="save-review">Сохранить</button>
                <button class="btn btn-reject" id="cancel-edit">Отмена</button>
            </div>
        </div>
    </div>
    
    <script>
        // Данные для админ-панели
        let adminReviews = [...reviews]; // Используем данные из основного скрипта
        let editingReviewId = null;
        
        // Инициализация админ-панели
        document.addEventListener('DOMContentLoaded', function() {
            initAdminPanel();
        });
        
        function initAdminPanel() {
            loadAdminReviews();
            setupAdminListeners();
            updateStats();
        }
        
        function loadAdminReviews() {
            const container = document.getElementById('admin-reviews-list');
            container.innerHTML = '';
            
            adminReviews.forEach(review => {
                const item = document.createElement('div');
                item.className = 'review-item';
                item.dataset.id = review.id;
                
                // Генерируем звезды
                let starsHtml = '';
                for (let i = 1; i <= 5; i++) {
                    starsHtml += i <= review.rating ? '★' : '☆';
                }
                
                item.innerHTML = `
                    <div class="review-header">
                        <div>
                            <strong>${review.name}</strong>
                            ${review.service ? `<span> • ${review.service}</span>` : ''}
                            <div style="color: #FFC107; margin-top: 5px;">${starsHtml}</div>
                        </div>
                        <div class="review-actions">
                            <button class="btn btn-edit" onclick="editReview(${review.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-approve" onclick="approveReview(${review.id})">
                                <i class="fas fa-check"></i>
                            </button>
                            <button class="btn btn-reject" onclick="deleteReview(${review.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <p>${review.text}</p>
                    <div style="font-size: 12px; color: #666; margin-top: 10px;">
                        ${review.date}
                    </div>
                `;
                
                container.appendChild(item);
            });
        }
        
        function setupAdminListeners() {
            // Навигация
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const section = this.dataset.section;
                    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                    document.getElementById(`${section}-section`).classList.add('active');
                });
            });
            
            // Звезды в модальном окне
            document.querySelectorAll('.edit-star').forEach(star => {
                star.addEventListener('click', function() {
                    const value = parseInt(this.dataset.value);
                    document.getElementById('edit-rating').value = value;
                    
                    document.querySelectorAll('.edit-star').forEach(s => {
                        const starValue = parseInt(s.dataset.value);
                        s.style.color = starValue <= value ? '#FFC107' : '#ddd';
                    });
                });
            });
            
            // Кнопки модального окна
            document.getElementById('save-review').addEventListener('click', saveReview);
            document.getElementById('cancel-edit').addEventListener('click', () => {
                document.getElementById('edit-modal').style.display = 'none';
            });
        }
        
        function editReview(id) {
            const review = adminReviews.find(r => r.id === id);
            if (!review) return;
            
            editingReviewId = id;
            
            document.getElementById('edit-name').value = review.name;
            document.getElementById('edit-text').value = review.text;
            document.getElementById('edit-rating').value = review.rating;
            
            // Устанавливаем звезды
            document.querySelectorAll('.edit-star').forEach(s => {
                const starValue = parseInt(s.dataset.value);
                s.style.color = starValue <= review.rating ? '#FFC107' : '#ddd';
            });
            
            // Заполняем выбор услуги
            const select = document.getElementById('edit-service');
            select.innerHTML = '<option value="">Не выбрано</option>';
            services.forEach(service => {
                const option = document.createElement('option');
                option.value = service.title;
                option.textContent = service.title;
                option.selected = service.title === review.service;
                select.appendChild(option);
            });
            
            document.getElementById('edit-modal').style.display = 'flex';
        }
        
        function saveReview() {
            if (!editingReviewId) return;
            
            const name = document.getElementById('edit-name').value;
            const text = document.getElementById('edit-text').value;
            const rating = parseInt(document.getElementById('edit-rating').value);
            const service = document.getElementById('edit-service').value;
            
            const reviewIndex = adminReviews.findIndex(r => r.id === editingReviewId);
            if (reviewIndex !== -1) {
                adminReviews[reviewIndex] = {
                    ...adminReviews[reviewIndex],
                    name,
                    text,
                    rating,
                    service: service || null
                };
                
                // Обновляем в основном массиве тоже
                const mainIndex = reviews.findIndex(r => r.id === editingReviewId);
                if (mainIndex !== -1) {
                    reviews[mainIndex] = adminReviews[reviewIndex];
                }
            }
            
            document.getElementById('edit-modal').style.display = 'none';
            loadAdminReviews();
            updateStats();
        }
        
        function approveReview(id) {
            alert(`Отзыв #${id} одобрен`);
        }
        
        function deleteReview(id) {
            if (confirm('Вы уверены, что хотите удалить этот отзыв?')) {
                adminReviews = adminReviews.filter(r => r.id !== id);
                reviews = reviews.filter(r => r.id !== id);
                loadAdminReviews();
                updateStats();
            }
        }
        
        function updateStats() {
            // Общее количество отзывов
            document.getElementById('total-reviews').textContent = adminReviews.length;
            
            // Средний рейтинг
            if (adminReviews.length > 0) {
                const totalRating = adminReviews.reduce((sum, review) => sum + review.rating, 0);
                const avgRating = totalRating / adminReviews.length;
                document.getElementById('avg-rating').textContent = avgRating.toFixed(1);
            }
            
            // Общее количество медиа
            let totalMedia = 0;
            Object.values(galleryData).forEach(category => {
                totalMedia += category.items.length;
            });
            document.getElementById('total-media').textContent = totalMedia;
            
            // Количество услуг
            document.getElementById('total-services').textContent = services.length;
        }
    </script>
</body>
</html>
